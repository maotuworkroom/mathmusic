{"version":3,"sources":["api/synthesize.js","components/graph.js","components/editor/editor-controls.js","components/editor/editor-output.js","components/editor/editor-panel.js","components/editor/track-timeline.js","components/editor/track-options.js","components/editor.js","components/modals/save-modal.js","components/modals/load-modal.js","components/modals/settings-modal.js","components/modals/alert-modal.js","components/modals.js","initial-state.js","App.js","api/handlers.js","serviceWorker.js","index.js"],"names":["SampleTrackGraph","segments","multiplier","data","forEach","segment","index","lengthMs","length","error","value","offsetMs","i","offsetLength","sampleInput","range","func","expression","simplify","compile","sampleOutput","map","x","evaluate","shiftedSampleInput","push","mode","y","Plotly","require","Plot","createPlotlyComponent","Graph","react_default","a","createElement","className","useResizeHandler","revision","this","props","getRevision","config","displayModeBar","layout","showlegend","autosize","xaxis","title","yaxis","upperRange","margin","t","l","r","b","pad","Component","styles","button","backgroundColor","fontWeight","EditorControls","_this","Button","variant","size","style","onClick","onAddTrack","index_es","flexGrow","Object","assign","marginRight","toggleModal","EditorOutput","output","react_tex","texContent","concat","parse","toTex","width","equation","volume","EditorPanel","_this$props","selectedSegment","timelines","col","j","row","TextField","id","label","helperText","onChange","event","onTrackDataChange","target","editor_output","IconButton","onDeleteSegment","reorder","list","startIndex","endIndex","result","Array","from","_result$splice","splice","removed","slicedToArray","TrackTimeline","onDragEnd","destination","source","onSegmentRearrange","rowIndex","_this2","react_beautiful_dnd_esm","droppableId","direction","provided","snapshot","ref","innerRef","isDraggingOver","background","display","justifyContent","padding","overflow","droppableProps","colIndex","key","draggableId","draggableProps","dragHandleProps","isDragging","draggableStyle","isSelected","objectSpread","userSelect","marginLeft","minHeight","textOverflow","whiteSpace","alignSelf","borderBottom","onSegmentSelection","placeholder","onAddSegment","TrackOptions","onDeleteTrack","InputBase","options","inputProps","fontSize","onTrackOptionChange","ToggleButtonGroup","exclusive","wave","e","val","ToggleButton","selected","mute","Editor","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","animate","timer","setInterval","animateGraph","classes","trackTimelines","selectedSegmentData","tl","track_options","track_timeline","ExpansionPanel","defaultExpanded","root","expanded","TransitionProps","onEnter","onEntered","clearInterval","onExit","onExited","ExpansionPanelSummary","expandIcon","Typography","heading","ExpansionPanelDetails","details","editor_controls","editor_panel","withStyles","theme","flex","&$expanded","typography","pxToRem","wdith","SaveModal","_React$useState","React","useState","getModalStyle","modalStyle","useStyles","Modal","open","paper","multiline","textField","rows","currentComposition","download","href","encodeURIComponent","maxWidth","LoadModal","_useState","_useState3","_useState4","text","setText","onDrop","useCallback","acceptedFiles","reader","FileReader","onabort","alert","onerror","onload","file","readAsText","_useDropzone","useDropzone","accept","multiple","getRootProps","getInputProps","onLoadJson","graphRange","fs","SettingsModal","_props$settings","settings","aliasing","flexDirection","FormControlLabel","marginTop","control","Switch","checked","labelPlacement","Link","role","aria-label","resetSettings","errorKeyMap","AlertModal","listItems","errors","ListItem","ListItemText","primary","Divider","editor","err","List","top","left","transform","makeStyles","position","palette","boxShadow","shadows","spacing","outline","initial_state","compositionErrors","showingModals","load","save","App","handlePlay","getCompositionErrors","composition","exportCompositionJson","JSON","stringify","state","rawBuffer","wasm","synthesize_composition","audioSourceBuffer","audioContext","createBuffer","copyToChannel","audioSource","createBufferSource","buffer","audioSources","connect","start","handleStop","stop","handleAnimateGraph","setState","initialState","settingsChange","field","parsedVal","parseInt","isNaN","bind","assertThisInitialized","trackDataChange","segmentCol","segmentRow","message","kind","segmentSelection","selectedRowIndex","selectedColumnIndex","segmentRearrange","sourceColIndex","destinationColIndex","_this$state","addSegment","toConsumableArray","idCount","deleteSegment","_this$state2","trackOptionChange","addTrack","deleteTrack","_this$state3","_i","_Object$entries","entries","_ref6","_ref2","timeline","_i2","_Object$entries2","_ref5","_ref4","minimizedJson","expr","traverse","node","type","op","implicit","_unused","toString","loadCompositionJson","json","parsedJson","isArray","oldSegment","segmentId","_this3","count","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","return","window","AudioContext","webkitAudioContext","__webpack_require__","then","AppBar","Toolbar","color","graph","components_editor","Boolean","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.159cc30a.chunk.js","sourcesContent":["import { map, range } from 'lodash';\r\nimport { simplify } from 'mathjs';\r\n\r\nconst wavewaves = {\r\n  sine: (x) => (Math.sin(x)),\r\n  triangle: (x) => (2/Math.PI * Math.asin(Math.sin(x))),\r\n  saw: (x) => (1/Math.PI * Math.atan(Math.tan(x/2 + Math.PI/2)))\r\n  //saw: (x) => (-2/Math.PI * (Math.PI / 2 - Math.atan(Math.tan(x/2 + Math.PI/2))) + 1)\r\n  //saw: (x) => (2*(x/Math.PI + 0.5 - Math.floor(x/Math.PI + 0.5)) - 1)\r\n};\r\n\r\nconst SampleTrackGraph = (segments, multiplier) => {\r\n  if (segments === null) return;\r\n  const data = [];\r\n\r\n  segments.forEach((segment, index) => {\r\n    const lengthMs = (!segment.length.error ? segment.length.value : 0);\r\n    let offsetMs = 0;\r\n    for (let i = 0; i < index; i++) {\r\n      let offsetLength = !segments[i].length.error ? segments[i].length.value : 0;\r\n      offsetMs += offsetLength;\r\n    }\r\n\r\n    const sampleInput = range(0, lengthMs / 1000, 1 / 1000);\r\n    const func = (!segment.expression.error ? simplify(segment.expression.value) : simplify(\"0\")).compile();\r\n    const sampleOutput = map(sampleInput, (x) => func.evaluate({ x: multiplier * x }));\r\n    const shiftedSampleInput = map(sampleInput, (x) => (x + offsetMs / 1000));\r\n\r\n    data.push({\r\n      mode: \"lines\",\r\n      x: shiftedSampleInput,\r\n      y: sampleOutput\r\n    });\r\n  });\r\n  return data;\r\n};\r\n\r\nconst SynthesizeComposition = (timelines, settings) => {\r\n  const { volume, multiplier, fs, aliasing } = settings;\r\n  // Find buffer size\r\n  let maxLengthMs = 0;\r\n  const trackLengthsMs = [];\r\n  timelines.forEach((timeline) => {\r\n    let trackLengthMs = 0;\r\n    timeline.segments.forEach((segment) => {\r\n      trackLengthMs += !segment.length.error ? segment.length.value : 0;\r\n    });\r\n    trackLengthsMs.push(trackLengthMs);\r\n    if (trackLengthMs > maxLengthMs) maxLengthMs = trackLengthMs;\r\n  });\r\n\r\n  // Synthesize\r\n  const bufferSize = maxLengthMs / 1000 * fs.value;\r\n  const rawBuffer = new Float32Array(bufferSize + 1);\r\n\r\n  timelines.forEach((timeline) => {\r\n    let bufferIndex = 1;\r\n    const phase = new Float32Array(bufferSize + 1);\r\n    const waveFunc = wavewaves[timeline.options.wave];\r\n    const muteMultiplier = timeline.options.mute ? 0 : 1;\r\n\r\n    timeline.segments.forEach((segment) => {\r\n      const func = simplify(segment.expression.value);\r\n      for (let i = 0; i <= segment.length.value / 1000; i += 1/fs.value) {\r\n        let tone = func.evaluate({x: multiplier.value * i});\r\n\r\n        if (!aliasing && (tone > fs.value/2 || tone < 0)) tone = 0;\r\n        let volumeMultiplier = segment.volume.value * volume.value / 10000 * muteMultiplier;\r\n\r\n        phase[bufferIndex] = phase[bufferIndex - 1] + 2 * Math.PI * tone/fs.value;\r\n        if (phase[bufferIndex] > 2 * Math.PI)\r\n          phase[bufferIndex] -= 2 * Math.PI;\r\n        else if (phase[bufferIndex] < -2 * Math.PI)\r\n          phase[bufferIndex] += 2 * Math.PI;\r\n\r\n        rawBuffer[bufferIndex] += volumeMultiplier * waveFunc(phase[bufferIndex]);\r\n        bufferIndex++;\r\n      }\r\n    });\r\n  });\r\n  \r\n  // TODO: Exponentially decress gain near end\r\n  \r\n  return rawBuffer;\r\n\r\n};\r\n\r\n\r\nexport { SampleTrackGraph, SynthesizeComposition };\r\n","import React, { Component } from 'react';\r\n\r\nimport createPlotlyComponent from 'react-plotly.js/factory';\r\n\r\nimport { SampleTrackGraph } from '../api/synthesize';\r\n\r\nvar Plotly = require('plotly.js/lib/core');\r\nconst Plot = createPlotlyComponent(Plotly);\r\n\r\nclass Graph extends Component {\r\n\r\n  render() {\r\n    return (\r\n      <Plot\r\n        className=\"Graph\"\r\n        useResizeHandler\r\n        revision={this.props.getRevision}\r\n        config={{\r\n          displayModeBar: false\r\n        }}\r\n        data={SampleTrackGraph(this.props.data, this.props.multiplier)}\r\n        layout={{\r\n          showlegend: false,\r\n          autosize: true,\r\n          xaxis: { title: \"Time (s)\" },\r\n          yaxis: {\r\n            title: \"Frequency (Hz)<br />&nbsp;\",\r\n            range: [0, this.props.upperRange]\r\n          },\r\n          margin: {\r\n            t: 40,\r\n            l: 85,\r\n            r: 50,\r\n            b: 80,\r\n            pad: 5\r\n          }\r\n        }}\r\n      />\r\n    );\r\n  }\r\n\r\n}\r\n\r\nexport default Graph;\r\n","import React, { Component } from 'react';\r\n\r\nimport { Button } from '@material-ui/core/';\r\nimport { Plus, ContentSave, Upload } from 'mdi-material-ui';\r\n\r\nconst styles = {\r\n  button: {\r\n    backgroundColor: \"#f5f5f5\",\r\n    fontWeight: 500\r\n  }\r\n}\r\n\r\nclass EditorControls extends Component {\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"EditorOptions\">\r\n        <Button variant=\"contained\" size=\"medium\" style={styles.button} onClick={this.props.onAddTrack}>\r\n          Track&nbsp;<Plus />\r\n        </Button>\r\n        <div style={{ flexGrow: 1 }} />\r\n        <Button variant=\"contained\" size=\"medium\" style={Object.assign({ marginRight: 10 }, styles.button)}\r\n          onClick={() => this.props.toggleModal(\"load\")}\r\n        >\r\n          Load&nbsp;<Upload />\r\n        </Button>\r\n        <Button variant=\"contained\" size=\"medium\" style={styles.button}\r\n          onClick={() => this.props.toggleModal(\"save\")}\r\n        >\r\n          Save&nbsp;<ContentSave />\r\n        </Button>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default EditorControls;\r\n","import React, { Component } from 'react';\r\n\r\nimport { Tex } from 'react-tex';\r\n\r\nimport { parse, simplify } from 'mathjs';\r\n\r\nconst GenerateTex = (expression) => {\r\n  return `\\\\Large f(x)=${simplify(parse(expression)).toTex()}`;\r\n}\r\n\r\nclass EditorOutput extends Component {\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"EditorOutput\">\r\n        <span style={{marginRight: 25}}>Output:</span>\r\n        { !this.props.error\r\n          ? <Tex texContent={GenerateTex(this.props.output)}/>\r\n          : <span className=\"EditorOutputError\">{this.props.output}</span>\r\n        }\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default EditorOutput;\r\n","import React, { Component } from 'react';\r\n\r\nimport { IconButton, TextField } from '@material-ui/core';\r\nimport { Delete } from 'mdi-material-ui';\r\n\r\nimport EditorOutput from './editor-output';\r\n\r\nconst style = {\r\n  title: {\r\n    width: 100\r\n  },\r\n  equation: {\r\n    width: \"25%\"\r\n  },\r\n  length: {\r\n    width: 100\r\n  },\r\n  volume: {\r\n    width: 90\r\n  }\r\n}\r\n\r\nclass EditorPanel extends Component {\r\n\r\n  render() {\r\n    const { selectedSegment, timelines } = this.props;\r\n    const i = selectedSegment.col, j = selectedSegment.row;\r\n    return (\r\n      <div className=\"EditorPanel\">\r\n        <TextField\r\n          id=\"standard-name\"\r\n          label=\"Title\"\r\n          value={this.props.title.value}\r\n          error={!!this.props.title.error}\r\n          helperText={this.props.title.error}\r\n          onChange={(event) => this.props.onTrackDataChange(timelines, i, j, 'title', event.target.value)}\r\n          margin=\"normal\"\r\n          style={style.title}\r\n        />\r\n        <TextField\r\n          label=\"Equation f(x)\"\r\n          value={this.props.expression.value}\r\n          error={!!this.props.expression.error}\r\n          helperText={!!this.props.expression.error ? \"See output\" : \"\"}\r\n          onChange={(event) => this.props.onTrackDataChange(timelines, i, j, 'expression', event.target.value)}\r\n          margin=\"normal\"\r\n          style={style.equation}\r\n        />\r\n        <TextField\r\n          label=\"Length (ms)\"\r\n          value={this.props.length.value}\r\n          error={!!this.props.length.error}\r\n          helperText={this.props.length.error}\r\n          onChange={(event) => this.props.onTrackDataChange(timelines, i, j, 'length', event.target.value)}\r\n          margin=\"normal\"\r\n          style={style.length}\r\n        />\r\n        <TextField\r\n          label=\"Volume (%)\"\r\n          value={this.props.volume.value}\r\n          error={!!this.props.volume.error}\r\n          helperText={this.props.volume.error}\r\n          onChange={(event) => this.props.onTrackDataChange(timelines, i, j, 'volume', event.target.value)}\r\n          margin=\"normal\"\r\n          style={style.volume}\r\n        />\r\n        <EditorOutput\r\n          output={!!this.props.expression.error ? this.props.expression.error : this.props.expression.value}\r\n          error={!!this.props.expression.error}\r\n        />\r\n        <IconButton onClick={() => this.props.onDeleteSegment()}>\r\n          <Delete />\r\n        </IconButton>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default EditorPanel;\r\n","import React, { Component } from 'react';\r\n\r\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\r\nimport { IconButton } from \"@material-ui/core\";\r\nimport { Plus } from 'mdi-material-ui';\r\n\r\n// a little function to help us with reordering the result\r\nconst reorder = (list, startIndex, endIndex) => {\r\n  const result = Array.from(list);\r\n  const [removed] = result.splice(startIndex, 1);\r\n  result.splice(endIndex, 0, removed);\r\n\r\n  return result;\r\n};\r\n\r\nconst getStyle = (isDragging, draggableStyle, isSelected) => ({\r\n  // some basic styles to make the items look a bit nicer\r\n  userSelect: 'none',\r\n  marginLeft: 5,\r\n  padding: 5,\r\n  minHeight: 16,\r\n  overflow: 'hidden',\r\n  textOverflow: 'ellipsis',\r\n  whiteSpace: 'nowrap',\r\n  alignSelf: 'center',\r\n  // change background colour if dragging\r\n  background: '#ffa4a2',\r\n  borderBottom: isSelected ? '2px solid #EE6E73' : '2px solid #ffa4a2',\r\n\r\n  // styles we need to apply on draggables\r\n  ...draggableStyle,\r\n});\r\n\r\nconst getListStyle = isDraggingOver => ({\r\n  background: isDraggingOver ? '#af4448' : '#ffa4a2',\r\n  display: 'flex',\r\n  justifyContent: 'flex-start',\r\n  padding: 8,\r\n  overflow: 'auto',\r\n  flexGrow: 1,\r\n  width: '100%'\r\n});\r\n\r\nclass TrackTimeline extends Component {\r\n\r\n  onDragEnd = (result) => {\r\n    // dropped outside the list\r\n    if (!result.destination) {\r\n      return;\r\n    }\r\n\r\n    const segments = reorder(\r\n      this.props.segments,\r\n      result.source.index,\r\n      result.destination.index\r\n    );\r\n\r\n    this.props.onSegmentRearrange(this.props.rowIndex, result.source.index, result.destination.index, segments);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <DragDropContext onDragEnd={this.onDragEnd}>\r\n        <Droppable droppableId=\"droppable\" direction=\"horizontal\">\r\n          {(provided, snapshot) => (\r\n            <div\r\n              ref={provided.innerRef}\r\n              style={getListStyle(snapshot.isDraggingOver)}\r\n              {...provided.droppableProps}\r\n            >\r\n              {this.props.segments.map((segment, colIndex) => {\r\n                return (\r\n                  <Draggable key={segment.id} draggableId={segment.id} index={colIndex}>\r\n                    {(provided, snapshot) => (\r\n                      <div\r\n                        ref={provided.innerRef}\r\n                        {...provided.draggableProps}\r\n                        {...provided.dragHandleProps}\r\n                        style={getStyle(\r\n                          snapshot.isDragging,\r\n                          provided.draggableProps.style,\r\n                          (this.props.selectedSegment.row === this.props.rowIndex && \r\n                           this.props.selectedSegment.col === colIndex)\r\n                        )}\r\n                        onClick={() => this.props.onSegmentSelection(this.props.rowIndex, colIndex)}\r\n                      >\r\n                        {segment.title.value}\r\n                      </div>\r\n                    )}\r\n                  </Draggable>)\r\n              })}\r\n              {provided.placeholder}\r\n              <div className=\"verticalDivider\"></div>\r\n              <IconButton onClick={() => this.props.onAddSegment(this.props.rowIndex)} size='small'><Plus /></IconButton>\r\n            </div>\r\n          )}\r\n        </Droppable>\r\n      </DragDropContext>\r\n    )\r\n  }\r\n}\r\n\r\nexport default TrackTimeline;\r\n","import React, { Component } from 'react';\r\n\r\nimport { Button, InputBase } from '@material-ui/core/';\r\nimport { ToggleButton, ToggleButtonGroup } from '@material-ui/lab/'\r\nimport { VolumeMute, CurrentAc, HandSaw, TriangleOutline, Minus } from 'mdi-material-ui';\r\n\r\nclass TrackOptions extends Component {\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"TrackControl\">\r\n        { this.props.rowIndex !== 0\r\n          ? <Button variant=\"contained\" size=\"medium\" onClick={() => this.props.onDeleteTrack(this.props.rowIndex)}\r\n              style={{marginRight: 10, backgroundColor: '#f5f5f5', fontWeight: 500}}\r\n            >\r\n              Track&nbsp; <Minus />\r\n            </Button>\r\n          : <div style={{width: 120}}/>}\r\n        <InputBase value={this.props.options.title} className=\"trackTitle\"\r\n          inputProps={{ style: { fontSize: 16, padding: \"6px 3px 5px\", backgroundColor: \"#f5f5f5\" } }}\r\n          onChange={(event) => this.props.onTrackOptionChange(this.props.rowIndex, 'title', event.target.value)}\r\n        />\r\n        <ToggleButtonGroup size=\"small\" exclusive={true}\r\n          value={this.props.options.wave}\r\n          onChange={(e, val) => this.props.onTrackOptionChange(this.props.rowIndex, 'wave', val)}\r\n        >\r\n          <ToggleButton size=\"small\" value='sine'>\r\n            <CurrentAc />\r\n          </ToggleButton>\r\n          <ToggleButton size=\"small\" value='triangle'>\r\n            <TriangleOutline />\r\n          </ToggleButton>\r\n          <ToggleButton size=\"small\" value='saw'>\r\n            <HandSaw />\r\n          </ToggleButton>\r\n        </ToggleButtonGroup>\r\n        <ToggleButtonGroup size=\"small\" style={{ marginLeft: 10 }}>\r\n          <ToggleButton size=\"small\"\r\n            selected={this.props.options.mute}\r\n            value='mute' onClick={() => this.props.onTrackOptionChange(this.props.rowIndex, 'mute', '')}\r\n          >\r\n            <VolumeMute />\r\n          </ToggleButton>\r\n        </ToggleButtonGroup>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default TrackOptions;\r\n","import React, { Component } from 'react';\r\n\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\nimport { ExpansionPanel, ExpansionPanelSummary, ExpansionPanelDetails } from '@material-ui/core/';\r\n\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { ChevronUp } from 'mdi-material-ui';\r\n\r\nimport EditorControls from './editor/editor-controls';\r\nimport EditorPanel from './editor/editor-panel';\r\nimport TrackTimeline from './editor/track-timeline';\r\nimport TrackOptions from './editor/track-options';\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    backgroundColor: \"#ffa4a2\",\r\n    flex: 0,\r\n    '&$expanded': {\r\n      margin: 0,\r\n    }\r\n  },\r\n  heading: {\r\n    fontSize: theme.typography.pxToRem(20),\r\n    fontWeight: 600\r\n  },\r\n  details: {\r\n    wdith: \"100%\",\r\n    backgroundColor: \"black\",\r\n    padding: 0\r\n  },\r\n  expanded: {\r\n    margin: 0\r\n  }\r\n});\r\n\r\nclass Editor extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.timer = null;\r\n  }\r\n\r\n  animate = () => {\r\n    this.timer = setInterval(this.props.animateGraph, 16);\r\n  }\r\n\r\n  render() {\r\n    const { classes, selectedSegment, timelines } = this.props;\r\n    const trackTimelines = [];\r\n    const selectedSegmentData = timelines[selectedSegment.row].segments[selectedSegment.col]\r\n\r\n    this.props.timelines.forEach((tl, rowIndex) => {\r\n      trackTimelines.push(\r\n        <div key={rowIndex} className=\"EditorTimelineRow\">\r\n          <TrackOptions\r\n            options={tl.options} rowIndex={rowIndex}\r\n            onTrackOptionChange={this.props.onTrackOptionChange}\r\n            onDeleteTrack={this.props.onDeleteTrack}  \r\n          />\r\n          <TrackTimeline\r\n            segments={tl.segments} rowIndex={rowIndex}\r\n            selectedSegment={selectedSegment}\r\n            onSegmentSelection={this.props.onSegmentSelection}\r\n            onSegmentRearrange={this.props.onSegmentRearrange}\r\n            onAddSegment={this.props.onAddSegment}\r\n          />\r\n        </div>\r\n      );\r\n    });\r\n\r\n    return (\r\n      <ExpansionPanel defaultExpanded={true} classes={{root: classes.root, expanded: classes.expanded}}\r\n        TransitionProps={{\r\n          onEnter: this.animate, onEntered: () => clearInterval(this.timer),\r\n          onExit: this.animate, onExited: () => clearInterval(this.timer)\r\n        }}\r\n      >\r\n        <ExpansionPanelSummary expandIcon={<ChevronUp />}>\r\n          <Typography className={classes.heading}>Timeline Editor</Typography>\r\n        </ExpansionPanelSummary>\r\n        <ExpansionPanelDetails classes={{root: classes.details}}>\r\n          <div className=\"Editor\">\r\n            <EditorControls\r\n              onAddTrack={this.props.onAddTrack}\r\n              toggleModal={this.props.toggleModal}\r\n            />\r\n            <div className=\"EditorTimelineContainer\">\r\n              {trackTimelines}\r\n            </div>\r\n            { selectedSegmentData\r\n              ? <EditorPanel\r\n                  title={selectedSegmentData.title}\r\n                  expression={selectedSegmentData.expression}\r\n                  length={selectedSegmentData.length}\r\n                  volume={selectedSegmentData.volume}\r\n                  onTrackDataChange={this.props.onTrackDataChange}\r\n                  onDeleteSegment={this.props.onDeleteSegment}\r\n                  timelines={timelines}\r\n                  selectedSegment={selectedSegment}\r\n                />\r\n              : <div className=\"EmptyEditorPanel\"/>\r\n              }\r\n          </div>\r\n        </ExpansionPanelDetails>\r\n      </ExpansionPanel>\r\n    );\r\n  }\r\n\r\n}\r\n\r\nexport default withStyles(styles)(Editor);\r\n","import React from 'react';\r\n\r\nimport { Button, Modal, TextField, Typography } from '@material-ui/core/';\r\n\r\nimport { getModalStyle, useStyles } from '../modals';\r\n\r\nexport default function SaveModal(props) {\r\n  const [modalStyle] = React.useState(getModalStyle);\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Modal open={props.open}>\r\n      <div style={modalStyle} className={classes.paper}>\r\n        <Typography variant=\"h5\">\r\n          Save Composition\r\n        </Typography>\r\n        <br />\r\n        <Typography variant=\"subtitle1\">\r\n          Copy the text below\r\n        </Typography>\r\n        <TextField\r\n          label=\"Output\" multiline className={classes.textField}\r\n          rows=\"7\" value={props.currentComposition} margin=\"normal\" variant=\"filled\"\r\n        />\r\n        <br />\r\n        <Typography variant=\"subtitle1\">\r\n          or\r\n        </Typography>\r\n        <Button variant=\"contained\" download=\"composition.json\" target=\"_blank\"\r\n          href={`data:text/json;charset=utf-8,${encodeURIComponent(props.currentComposition)}`}\r\n          style={{maxWidth: 200, alignSelf: \"center\"}}\r\n        >\r\n          Save Json\r\n        </Button>\r\n        <br />\r\n        <div className=\"modalActions\">\r\n          <Button variant=\"contained\" onClick={() => props.toggleModal(\"save\")}>Close</Button>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","import React, { useState, useCallback } from 'react';\r\n\r\nimport { Button, Modal, TextField, Typography } from '@material-ui/core/';\r\nimport { useDropzone } from 'react-dropzone';\r\n\r\nimport { getModalStyle, useStyles } from '../modals';\r\n\r\nexport default function LoadModal(props) {\r\n  const [modalStyle] = useState(getModalStyle);\r\n  const [text, setText] = useState('');\r\n  const classes = useStyles();\r\n\r\n  const onDrop = useCallback(acceptedFiles => {\r\n    const reader = new FileReader()\r\n\r\n    reader.onabort = () => alert(\"File reading aborted\");\r\n    reader.onerror = () => alert(\"File reading has failed\");\r\n    reader.onload = () => {\r\n      // Might be a good idea to do error checking here... (check if valid json)\r\n      setText(reader.result);\r\n    }\r\n\r\n    acceptedFiles.forEach(file => reader.readAsText(file));\r\n  }, []);\r\n\r\n  const { getRootProps, getInputProps } = useDropzone({ onDrop, accept: \".json\", multiple: false });\r\n\r\n  return (\r\n    <Modal open={props.open}>\r\n      <div style={modalStyle} className={classes.paper}>\r\n        <Typography variant=\"h5\">\r\n          Load Composition\r\n        </Typography>\r\n        <br />\r\n        <Typography variant=\"subtitle1\">\r\n          Paste json below\r\n        </Typography>\r\n        <TextField\r\n          label=\"Input\" multiline className={classes.textField}\r\n          rows=\"7\" value={text} margin=\"normal\" variant=\"filled\"\r\n          onChange={(e) => setText(e.target.value)}\r\n        />\r\n        <br />\r\n        <Typography variant=\"subtitle1\">\r\n          or\r\n        </Typography>\r\n        <br />\r\n        <div {...getRootProps()} className={\"LoadModalFileZone\"}>\r\n          <input {...getInputProps()} />\r\n          <p>Drag 'n' drop a file here, or click to select file</p>\r\n        </div>\r\n        <br />\r\n        <div className=\"modalActions\">\r\n          <Button variant=\"contained\" style={{ marginRight: 10 }} onClick={() => props.toggleModal(\"load\")}>Cancel</Button>\r\n          <Button variant=\"contained\" onClick={() => props.onLoadJson(text)}>Load</Button>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","import React from 'react';\r\n\r\nimport { Button, FormControlLabel, Link, Modal, Switch, TextField, Typography } from '@material-ui/core/';\r\n\r\nimport { getModalStyle, useStyles } from '../modals';\r\n\r\nconst style = {\r\n  volume: {\r\n    width: 139\r\n  },\r\n  multiplier: {\r\n    width: 250\r\n  },\r\n  graphRange: {\r\n    width: 173\r\n  },\r\n  fs: {\r\n    width: 180\r\n  }\r\n};\r\n\r\nexport default function SettingsModal(props) {\r\n  const [modalStyle] = React.useState(getModalStyle);\r\n  const classes = useStyles();\r\n  const { fs, volume, multiplier, graphRange, aliasing } = props.settings;\r\n  return (\r\n    <Modal open={props.open}>\r\n      <div style={modalStyle} className={classes.paper}>\r\n        <div style={{ display: \"flex\", flexDirection: \"row\" }}>\r\n          <div className=\"settingsColumn\">\r\n            <Typography variant=\"h5\">\r\n              Settings\r\n            </Typography>\r\n            <TextField\r\n              label=\"Master volume (%)\"\r\n              value={volume.value}\r\n              error={!!volume.error}\r\n              helperText={volume.error}\r\n              onChange={(e) => props.onChange('volume', e.target.value) }\r\n              margin=\"normal\"\r\n              style={style.volume}\r\n            />\r\n            <TextField\r\n              label=\"Auto multipler for function input (x)\"\r\n              value={multiplier.value}\r\n              error={!!multiplier.error}\r\n              helperText={multiplier.error}\r\n              onChange={(e) => props.onChange('multiplier', e.target.value) }\r\n              margin=\"normal\"\r\n              style={style.multiplier}\r\n            />\r\n            <TextField\r\n              label=\"Upper graph range (Hz)\"\r\n              value={graphRange.value}\r\n              error={!!graphRange.error}\r\n              helperText={graphRange.error}\r\n              onChange={(e) => props.onChange('graphRange', e.target.value) }\r\n              margin=\"normal\"\r\n              style={style.graphRange}\r\n            />\r\n            <TextField\r\n              label=\"Sampling frequency (Hz)\"\r\n              value={fs.value}\r\n              error={!!fs.error}\r\n              helperText={fs.error}\r\n              onChange={(e) => props.onChange('fs', e.target.value) }\r\n              margin=\"normal\"\r\n              style={style.fs}\r\n            />\r\n            <FormControlLabel\r\n              style={{ alignSelf: \"flex-start\", marginLeft: 0, marginTop: 15 }}\r\n              control={<Switch checked={aliasing} onChange={() => props.onChange('aliasing')}/>}\r\n              label=\"Enable Aliasing\"\r\n              labelPlacement=\"start\"\r\n            />\r\n          </div>\r\n          <div className=\"aboutBorder\">\r\n            <Typography variant=\"h6\" style={{ alignSelf: \"center\" }}>\r\n              About Arithmusic\r\n            </Typography>\r\n            <Typography>\r\n              Version: 1.0.0<br />\r\n              Last updated: June 20, 2019<br />\r\n              <Link href=\"https://github.com/chrisdruta/arithmusic\" target=\"_blank\">\r\n                github.com/chrisdruta/arithmusic\r\n            </Link>\r\n            <br />\r\n            GPL v3.0\r\n            <br />\r\n            </Typography>\r\n            <Typography>\r\n              Made with <span role=\"img\" style={{ fontSize: 20 }} aria-label=\"heart\">❤️</span>,<br />\r\n              Chris Druta\r\n            </Typography>\r\n          </div>\r\n        </div>\r\n\r\n        <br />\r\n        <div className=\"modalActions\">\r\n          <Button variant=\"contained\" style={{marginRight: 10}} onClick={() => props.resetSettings()}>Defaults</Button>\r\n          <Button variant=\"contained\" onClick={() => props.toggleModal(\"settings\")}>Close</Button>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","import React from 'react';\r\n\r\nimport { Button, Divider, List, ListItem, ListItemText, Modal, Typography } from '@material-ui/core/';\r\n\r\nimport { getModalStyle, useStyles } from '../modals';\r\n\r\nconst errorKeyMap = {\r\n  fs: \"Sampling frequency\",\r\n  volume: \"Volume\",\r\n  multiplier: \"Auto multiplier\",\r\n  expression: \"Expression\",\r\n  length: \"Length\"\r\n}\r\n\r\nexport default function AlertModal(props) {\r\n  const [modalStyle] = React.useState(getModalStyle);\r\n  const classes = useStyles();\r\n\r\n  const listItems = [];\r\n  if (props.errors) {\r\n    props.errors.settings.forEach((key, index) => {\r\n      listItems.push(\r\n        <ListItem key={`s${index}`}>\r\n          <ListItemText primary={`${errorKeyMap[key]} in Settings`} />\r\n        </ListItem>\r\n      );\r\n      if (index !== props.errors.settings.length - 1) {\r\n        listItems.push(<Divider key={`ds${index}`} variant=\"middle\" />);\r\n      } else if (props.errors.editor.length) {\r\n        listItems.push(<Divider key={`ds${index}`} variant=\"middle\" />);\r\n      }\r\n    });\r\n\r\n    props.errors.editor.forEach((err, index) => {\r\n      listItems.push(\r\n        <ListItem key={`e${index}`}>\r\n          <ListItemText primary={`${errorKeyMap[err.key]} for tab titled '${err.title}' in Timeline [row ${err.row}, column ${err.col}]`}/>\r\n        </ListItem>\r\n      );\r\n      if (index !== props.errors.editor.length - 1) {\r\n        listItems.push(<Divider key={`de${index}`} variant=\"middle\" />);\r\n      }\r\n    });\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      open={props.open}\r\n    >\r\n      <div style={modalStyle} className={classes.paper}>\r\n        <Typography variant=\"h5\">\r\n          Composition Errors\r\n        </Typography>\r\n        <br />\r\n        <Typography variant=\"subtitle1\">\r\n          Please fix the following errors and try again\r\n        </Typography>\r\n        <List style={{ width: \"80%\" }}> {listItems} </List>\r\n        <br />\r\n        <div className=\"modalActions\">\r\n          <Button variant=\"contained\" onClick={() => props.toggleModal(\"alert\")}>Close</Button>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","import SaveModal from './modals/save-modal';\r\nimport LoadModal from './modals/load-modal';\r\nimport SettingsModal from './modals/settings-modal';\r\nimport AlertModal from './modals/alert-modal';\r\n\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nfunction getModalStyle() {\r\n  const top = 50;\r\n  const left = 50;\r\n  return {\r\n    top: `${top}%`,\r\n    left: `${left}%`,\r\n    transform: `translate(-${top}%, -${left}%)`,\r\n  };\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  paper: {\r\n    position: \"absolute\",\r\n    width: 600,\r\n    backgroundColor: theme.palette.background.paper,\r\n    boxShadow: theme.shadows[5],\r\n    padding: theme.spacing(4),\r\n    outline: \"none\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    justifyContent: \"space-evenly\"\r\n  },\r\n  textField: {\r\n\r\n  }\r\n}));\r\n\r\nexport {\r\n  SaveModal,\r\n  LoadModal,\r\n  SettingsModal,\r\n  AlertModal,\r\n  getModalStyle,\r\n  useStyles\r\n};\r\n","export default {\r\n  selectedSegment: { row: 0, col: 0 },\r\n  compositionErrors: null,\r\n  settings: {\r\n    fs: { value: 44100, error: \"\" },\r\n    volume: { value: 10, error: \"\" },\r\n    multiplier: { value: 1, error: \"\" },\r\n    graphRange: { value: 4000, error: \"\" },\r\n    aliasing: false\r\n  },\r\n  showingModals: {\r\n    load: false,\r\n    save: false,\r\n    settings: false,\r\n    alert: false\r\n  },\r\n  timelines: [\r\n    {\r\n      options: {\r\n        title: \"C2 Steps\",\r\n        wave: \"sine\",\r\n        mute: false\r\n      },\r\n      segments: [\r\n        { id: \"t0\", title: { value: \"C2\", error: \"\" }, expression: { value: \"65.41\", error: \"\" }, length: { value: 500, error: \"\" }, volume: { value: 100, error: \"\" } },\r\n        { id: \"t1\", title: { value: \"D2\", error: \"\" }, expression: { value: \"73.42\", error: \"\" }, length: { value: 500, error: \"\" }, volume: { value: 100, error: \"\" } },\r\n        { id: \"t2\", title: { value: \"E2\", error: \"\" }, expression: { value: \"82.41\", error: \"\" }, length: { value: 500, error: \"\" }, volume: { value: 100, error: \"\" } },\r\n        { id: \"t3\", title: { value: \"F2\", error: \"\" }, expression: { value: \"87.31\", error: \"\" }, length: { value: 500, error: \"\" }, volume: { value: 100, error: \"\" } },\r\n        { id: \"t4\", title: { value: \"G2\", error: \"\" }, expression: { value: \"98\", error: \"\" }, length: { value: 500, error: \"\" }, volume: { value: 100, error: \"\" } },\r\n        { id: \"t5\", title: { value: \"A3\", error: \"\" }, expression: { value: \"110\", error: \"\" }, length: { value: 500, error: \"\" }, volume: { value: 100, error: \"\" } },\r\n        { id: \"t6\", title: { value: \"B2\", error: \"\" }, expression: { value: \"123.47\", error: \"\" }, length: { value: 500, error: \"\" }, volume: { value: 100, error: \"\" } },\r\n        { id: \"t7\", title: { value: \"C3\", error: \"\" }, expression: { value: \"130.81\", error: \"\" }, length: { value: 500, error: \"\" }, volume: { value: 100, error: \"\" } }\r\n      ]\r\n    },\r\n    {\r\n      options: {\r\n        title: \"C2 Linear\",\r\n        wave: \"sine\",\r\n        mute: false\r\n      },\r\n      segments: [\r\n        { id: \"t8\", title: { value: \"Delay\", error: \"\" }, expression: { value: \"0\", error: \"\" }, length: { value: 4000, error: \"\" }, volume: { value: 100, error: \"\" } },\r\n        { id: \"t9\", title: { value: \"Linear Eqn\", error: \"\" }, expression: { value: \"130.81 + x * (65.41 - 130.81) / 4\", error: \"\" }, length: { value: 4000, error: \"\" }, volume: { value: 100, error: \"\" } }\r\n      ]\r\n    }\r\n  ]\r\n};\r\n","import React, { Component } from 'react';\r\nimport './App.css';\r\n\r\nimport { AppBar, Toolbar, IconButton } from '@material-ui/core';\r\nimport { Play, Stop, Tune } from 'mdi-material-ui';\r\n\r\nimport { settingsChange, trackDataChange, toggleModal, segmentSelection, segmentRearrange,\r\n         addSegment, deleteSegment, trackOptionChange, addTrack, deleteTrack, getCompositionErrors,\r\n         exportCompositionJson, loadCompositionJson, resetSettings\r\n} from './api/handlers';\r\n\r\nimport Graph from './components/graph';\r\nimport Editor from './components/editor';\r\nimport { SaveModal, LoadModal, SettingsModal, AlertModal } from './components/modals';\r\nimport initialState from './initial-state';\r\n\r\nclass App extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = initialState;\r\n    this.state.revision = 0;\r\n\r\n    this.settingsChange = settingsChange.bind(this);\r\n    this.trackDataChange = trackDataChange.bind(this);\r\n    this.toggleModal = toggleModal.bind(this);\r\n    this.segmentSelection = segmentSelection.bind(this);\r\n    this.segmentRearrange = segmentRearrange.bind(this);\r\n    this.addSegment = addSegment.bind(this);\r\n    this.deleteSegment = deleteSegment.bind(this);\r\n    this.trackOptionChange = trackOptionChange.bind(this);\r\n    this.addTrack = addTrack.bind(this);\r\n    this.deleteTrack = deleteTrack.bind(this);\r\n    this.getCompositionErrors = getCompositionErrors.bind(this);\r\n    this.exportCompositionJson = exportCompositionJson.bind(this);\r\n    this.loadCompositionJson = loadCompositionJson.bind(this);\r\n    this.resetSettings = resetSettings.bind(this);\r\n\r\n    let count = 0;\r\n    for (let tl of this.state.timelines) {\r\n      count += tl.segments.length;\r\n    }\r\n    this.idCount = count;\r\n\r\n    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();\r\n    this.audioSources = [];\r\n  }\r\n\r\n  async componentDidMount () {\r\n    this.wasm = await import('synthesis');\r\n  }\r\n\r\n  handlePlay =  () => {\r\n\r\n    // Check for errors before synthesizing\r\n    const errors = this.getCompositionErrors();\r\n    if (errors) {\r\n      this.toggleModal(\"alert\");\r\n      return;\r\n    }\r\n\r\n    const composition = this.exportCompositionJson();\r\n    const settings = JSON.stringify({\r\n      fs: this.state.settings.fs.value,\r\n      volume: this.state.settings.volume.value,\r\n      multiplier: this.state.settings.multiplier.value,\r\n      aliasing: this.state.settings.aliasing\r\n    });\r\n\r\n    const rawBuffer = this.wasm.synthesize_composition(composition, settings);\r\n    //const rawBuffer = SynthesizeComposition(this.state.timelines, this.state.settings);\r\n    const audioSourceBuffer = this.audioContext.createBuffer(1, rawBuffer.length, this.state.settings.fs.value);\r\n    audioSourceBuffer.copyToChannel(rawBuffer, 0);\r\n    const audioSource = this.audioContext.createBufferSource();\r\n    audioSource.buffer = audioSourceBuffer;\r\n\r\n    this.audioSources.push(audioSource);\r\n\r\n    audioSource.connect(this.audioContext.destination);\r\n    audioSource.start(0);\r\n  }\r\n\r\n  handleStop = () => {\r\n    this.audioSources.forEach((source) => source.stop(0));\r\n  }\r\n\r\n  handleAnimateGraph = () => {\r\n    this.setState({ revision: this.state.revision + 1 });\r\n  }\r\n\r\n  render() {\r\n    const { timelines } = this.state;\r\n    return (\r\n      <div className=\"App\">\r\n        <AppBar position=\"static\">\r\n          <Toolbar className=\"AppBar\">\r\n            <span className=\"title\">\r\n              Arithmusic\r\n            </span>\r\n            <div style={{ flexGrow: 1 }}></div>\r\n            <IconButton color=\"inherit\" onClick={this.handlePlay}><Play /></IconButton>\r\n            <IconButton color=\"inherit\" onClick={this.handleStop}><Stop /></IconButton>\r\n            <IconButton color=\"inherit\" onClick={() => this.toggleModal(\"settings\")}><Tune /></IconButton>\r\n          </Toolbar>\r\n        </AppBar>\r\n        <div className=\"AppContainer\">\r\n          <Graph\r\n            revision={this.state.revision} multiplier={this.state.settings.multiplier.value}\r\n            upperRange={this.state.settings.graphRange.value}\r\n            data={this.state.timelines[this.state.selectedSegment.row]\r\n              ? this.state.timelines[this.state.selectedSegment.row].segments : null\r\n            }\r\n          />\r\n          <Editor\r\n            animateGraph={this.handleAnimateGraph}\r\n            timelines={timelines}\r\n            selectedSegment={this.state.selectedSegment}\r\n            onSegmentSelection={this.segmentSelection}\r\n            onSegmentRearrange={this.segmentRearrange}\r\n            onAddTrack={this.addTrack}\r\n            onDeleteTrack={this.deleteTrack}\r\n            onTrackOptionChange={this.trackOptionChange}\r\n            onTrackDataChange={this.trackDataChange}\r\n            onAddSegment={this.addSegment}\r\n            onDeleteSegment={this.deleteSegment}\r\n            toggleModal={this.toggleModal}\r\n          />\r\n          <LoadModal open={this.state.showingModals.load}\r\n            toggleModal={this.toggleModal}\r\n            onLoadJson={this.loadCompositionJson}\r\n          />\r\n          <SaveModal open={this.state.showingModals.save}\r\n            toggleModal={this.toggleModal}\r\n            currentComposition={(this.exportCompositionJson())}\r\n          />\r\n          <SettingsModal open={this.state.showingModals.settings} settings={this.state.settings}\r\n            toggleModal={this.toggleModal} onChange={this.settingsChange} resetSettings={this.resetSettings}\r\n          />\r\n          <AlertModal open={this.state.showingModals.alert} errors={this.state.compositionErrors}\r\n            toggleModal={this.toggleModal}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import { parse, simplify } from 'mathjs';\r\n\r\n//#region User input with error checking handlers\r\nexport function getCompositionErrors() {\r\n  // Check settings\r\n  const settings = [];\r\n  for (let [key, value] of Object.entries(this.state.settings)) {\r\n    if (!!value.error && key !== \"graphRange\") {\r\n      settings.push(key);\r\n    }\r\n  }\r\n\r\n  // Check editor\r\n  const editor = [];\r\n  this.state.timelines.forEach((timeline, rowIndex) => {\r\n    timeline.segments.forEach((segment, colIndex) => {\r\n      for (let [key, value] of Object.entries(segment)) {\r\n        if (!!value.error) {\r\n          editor.push({ key: key, title: segment.title.value, row: rowIndex + 1, col: colIndex + 1});\r\n        }\r\n      }\r\n    });\r\n  });\r\n\r\n  if (settings.length || editor.length) {\r\n    this.setState({ compositionErrors: { settings, editor } });\r\n    return true;\r\n  } else {\r\n    this.setState({ compositionErrors: null });\r\n    return false;\r\n  }\r\n\r\n}\r\n\r\nexport function settingsChange(field, value) {\r\n  const settings = { ...this.state.settings };\r\n  let parsedVal;\r\n  if (field !== 'aliasing') {\r\n    parsedVal = parseInt(value);\r\n    settings[field].value = value;\r\n  }\r\n\r\n  // Error checking\r\n  if (field === 'volume') {\r\n    if (parsedVal >= 0) {\r\n      settings.volume.value = parsedVal;\r\n      settings.volume.error = \"\";\r\n    } else if (isNaN(parsedVal)) {\r\n      settings.volume.error = \"Not a number\";\r\n    } else {\r\n      settings.volume.error = \"Can't be negative\";\r\n    }\r\n\r\n  } else if (field === 'multiplier') {\r\n    if (isNaN(parsedVal)) {\r\n      settings.multiplier.error = \"Not a number\";\r\n    } else {\r\n      settings.multiplier.value = parsedVal;\r\n      settings.multiplier.error = \"\";\r\n    }\r\n\r\n  } else if (field === 'graphRange') {\r\n    if (isNaN(parsedVal)) {\r\n      settings.graphRange.error = \"Not a number\";\r\n    } else if (parsedVal < 0) {\r\n      settings.graphRange.error = \"Can't be negative\";\r\n    } else {\r\n      settings.graphRange.value = parsedVal;\r\n      settings.graphRange.error = \"\";\r\n    }\r\n\r\n  } else if (field === 'fs') {\r\n    if (isNaN(parsedVal)) {\r\n      settings.fs.error = \"Not a number\";\r\n    } else if (parsedVal < 3000) {\r\n      settings.fs.error = \"Must be at least 3000\";\r\n    } else if (parsedVal > 96000) {\r\n      settings.fs.error = \"Must be less than 96000\";\r\n    } else {\r\n      settings.fs.value = parsedVal;\r\n      settings.fs.error = \"\";\r\n    }\r\n\r\n  } else if (field === 'aliasing') {\r\n    settings.aliasing = !settings.aliasing;\r\n  }\r\n\r\n  this.setState({ settings }, () => this.getCompositionErrors());\r\n}\r\n\r\nexport function trackDataChange(timelines, segmentCol, segmentRow, field, value) {\r\n\r\n  // Set value so input is still interactive\r\n  timelines[segmentRow].segments[segmentCol][field].value = value;\r\n\r\n  // Error checking\r\n  if (field === \"title\") {\r\n    if (value.length > 0) {\r\n      timelines[segmentRow].segments[segmentCol].title.error = \"\";\r\n    } else {\r\n      timelines[segmentRow].segments[segmentCol].title.error = \"Too short\"\r\n    }\r\n\r\n  } else if (field === \"expression\") {\r\n    try {\r\n      const parsedMath = simplify(value);\r\n      parsedMath.evaluate({ x: 1 });\r\n      timelines[segmentRow].segments[segmentCol].expression.error = \"\";\r\n    } catch (e) {\r\n      timelines[segmentRow].segments[segmentCol].expression.error = e.message;\r\n    }\r\n    if (value.length === 0) {\r\n      timelines[segmentRow].segments[segmentCol].expression.error = \"Undefined\";\r\n    }\r\n\r\n  } else if (field === \"length\") {\r\n    const parsedVal = parseInt(value);\r\n    if (parsedVal >= 0) {\r\n      timelines[segmentRow].segments[segmentCol].length.value = parsedVal;\r\n      timelines[segmentRow].segments[segmentCol].length.error = \"\";\r\n    } else if (isNaN(parsedVal)) {\r\n      timelines[segmentRow].segments[segmentCol].length.error = \"Not a number\";\r\n    } else {\r\n      timelines[segmentRow].segments[segmentCol].length.error = \"Can't be negative\"\r\n    }\r\n\r\n  } else if (field === \"volume\") {\r\n    const parsedVal = parseInt(value);\r\n    if (parsedVal >= 0) {\r\n      timelines[segmentRow].segments[segmentCol].volume.value = parsedVal;\r\n      timelines[segmentRow].segments[segmentCol].volume.error = \"\";\r\n    } else if (isNaN(parsedVal)) {\r\n      timelines[segmentRow].segments[segmentCol].volume.error = \"Not a number\";\r\n    } else {\r\n      timelines[segmentRow].segments[segmentCol].volume.error = \"Can't be negative\"\r\n    }\r\n  }\r\n\r\n  this.setState({ timelines }, () => this.getCompositionErrors());\r\n}\r\n//#endregion\r\n\r\n//#region Editor state changes\r\nexport function segmentSelection(selectedRowIndex, selectedColumnIndex) {\r\n  this.setState({ selectedSegment: { row: selectedRowIndex, col: selectedColumnIndex } });\r\n}\r\n\r\nexport function segmentRearrange(rowIndex, sourceColIndex, destinationColIndex, segments) {\r\n  const { selectedSegment, timelines } = { ...this.state };\r\n  timelines[rowIndex].segments = segments;\r\n  this.setState({ timelines });\r\n\r\n  if (sourceColIndex === selectedSegment.col && rowIndex === selectedSegment.row) {\r\n    selectedSegment.col = destinationColIndex;\r\n    this.setState({ selectedSegment });\r\n  }\r\n}\r\n\r\nexport function addSegment(rowIndex) {\r\n  const timelines = [...this.state.timelines];\r\n\r\n  timelines[rowIndex].segments = [...timelines[rowIndex].segments,\r\n  {\r\n    id: `t${++this.idCount}`,\r\n    title: { value: \"New Tab\", error: \"\" },\r\n    expression: { value: \"440 + 100 * x\", error: \"\" },\r\n    length: { value: 500, error: \"\" },\r\n    volume: { value: 100, error: \"\" }\r\n  }\r\n  ];\r\n  this.setState({ timelines });\r\n}\r\n\r\nexport function deleteSegment() {\r\n  const { selectedSegment, timelines } = { ...this.state };\r\n\r\n  timelines[selectedSegment.row].segments.splice(selectedSegment.col, 1);\r\n  if (selectedSegment.col === 0) {\r\n    if (selectedSegment.row > 0) {\r\n      selectedSegment.row--;\r\n      selectedSegment.col = timelines[selectedSegment.row].segments.length - 1;\r\n    }\r\n  } else {\r\n    selectedSegment.col--;\r\n  }\r\n\r\n  this.setState({ selectedSegment, timelines });\r\n}\r\n\r\nexport function trackOptionChange(index, field, value) {\r\n  const { timelines } = this.state;\r\n  if (field === 'title') {\r\n    timelines[index].options.title = value;\r\n  } else if (field === 'wave') {\r\n    if (value === null)\r\n      timelines[index].options.wave = 'sine';\r\n    else\r\n      timelines[index].options.wave = value;\r\n  } else if (field === 'mute') {\r\n    timelines[index].options.mute = !timelines[index].options.mute;\r\n  }\r\n\r\n  this.setState({ timelines: timelines });\r\n}\r\n\r\nexport function addTrack() {\r\n  const timelines = [...this.state.timelines];\r\n  timelines.push({\r\n    options: {\r\n      title: 'Untitled Track',\r\n      wave: 'sine',\r\n      mute: false\r\n    },\r\n    segments: []\r\n  });\r\n\r\n  this.setState({ timelines: timelines });\r\n}\r\n\r\nexport function deleteTrack(rowIndex) {\r\n  const { selectedSegment, timelines } = { ...this.state };\r\n  timelines.splice(rowIndex, 1);\r\n  if (selectedSegment.row === rowIndex) {\r\n    selectedSegment.row--;\r\n    selectedSegment.col = 0;\r\n  }\r\n\r\n  this.setState({ selectedSegment, timelines });\r\n}\r\n//#endregion\r\n\r\n//#region Modal toggle handler\r\nexport function toggleModal(kind) {\r\n  const showingModals = { ...this.state.showingModals };\r\n  if (kind === \"save\" && this.state.compositionErrors) {\r\n    showingModals[\"alert\"] = true;\r\n  } else {\r\n    showingModals[kind] = !showingModals[kind];\r\n  }\r\n\r\n  this.setState({ showingModals });\r\n}\r\n\r\nexport function resetSettings() {\r\n  this.setState({\r\n    settings: {\r\n      fs: { value: 44100, error: \"\" },\r\n      volume: { value: 10, error: \"\" },\r\n      multiplier: { value: 1, error: \"\" },\r\n      graphRange: { value: 4000, error: \"\" },\r\n      aliasing: false\r\n    }\r\n  }, () => this.getCompositionErrors());\r\n}\r\n//#endregion\r\n\r\n//#region Json parsing\r\nexport function exportCompositionJson() {\r\n  const timelines = this.state.timelines;\r\n  const minimizedJson = [];\r\n\r\n  timelines.forEach((timeline) => {\r\n    const segments = [];\r\n    timeline.segments.forEach((segment) => {\r\n      // Remove explicit multiplication for rust compatibility\r\n      let expr = \"\";\r\n      try {\r\n        expr = parse(segment.expression.value);\r\n        expr.traverse((node) => {\r\n          if (node.type === 'OperatorNode' && node.op === '*' && node.implicit) {\r\n            node.implicit = !node.implicit;\r\n            return node;\r\n          }\r\n        });\r\n      } catch { /* Doesnt matter because save is disabled anyways */ }\r\n\r\n      segments.push({\r\n        title: segment.title.value,\r\n        expression: expr.toString(),\r\n        length: segment.length.value,\r\n        volume: segment.volume.value\r\n      });\r\n    });\r\n\r\n    minimizedJson.push({\r\n      options: timeline.options,\r\n      segments: segments\r\n    });\r\n  });\r\n\r\n  return JSON.stringify(minimizedJson);\r\n}\r\n\r\nexport function loadCompositionJson(json) {\r\n  const parsedJson = JSON.parse(json);\r\n  if (!Array.isArray(parsedJson)) {\r\n    // Make more robust\r\n    return \"Unexpected format\";\r\n  }\r\n\r\n  let id = 0;\r\n  try {\r\n    for (let rowIndex in parsedJson) {\r\n      for (let colIndex in parsedJson[rowIndex].segments) {\r\n        let oldSegment = { ...parsedJson[rowIndex].segments[colIndex] };\r\n        let segmentId = `t${id}`;\r\n\r\n        parsedJson[rowIndex].segments[colIndex] = {\r\n          title: {}, expression: {}, length: {}, volume: {}\r\n        };\r\n        parsedJson[rowIndex].segments[colIndex].id = segmentId;\r\n        this.trackDataChange(parsedJson, colIndex, rowIndex, \"title\", oldSegment.title);\r\n        this.trackDataChange(parsedJson, colIndex, rowIndex, \"expression\", oldSegment.expression);\r\n        this.trackDataChange(parsedJson, colIndex, rowIndex, \"length\", oldSegment.length);\r\n        this.trackDataChange(parsedJson, colIndex, rowIndex, \"volume\", oldSegment.volume);\r\n        id++;\r\n      }\r\n    }\r\n  } catch (e) {\r\n    alert(e.message);\r\n    return;\r\n  }\r\n\r\n\r\n  this.toggleModal(\"load\");\r\n  this.setState({ selectedSegment: { row: 0, col: 0 } });\r\n}\r\n////#endregion\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}